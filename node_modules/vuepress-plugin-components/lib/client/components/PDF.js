import{ref as v,computed as N,unref as c,onMounted as w,isRef as P,watch as F,defineComponent as C,h as $}from"vue";import{checkIsMobile as D,checkIsSafari as E,entries as I,useLocaleConfig as x}from"vuepress-shared/client";import"../styles/pdf.scss";import{isString as f,isLinkHttp as R,ensureEndingSlash as M}from"@vuepress/shared";import{useEventListener as b}from"@vueuse/core";import{withBase as y}from"@vuepress/client";const S=e=>f(e)?e:`${e}px`,U=(e,t=0)=>{const o=v(),n=N(()=>S(c(e.width)||"100%")),r=v("auto"),d=s=>{if(f(s)){const[l,u]=s.split(":"),p=Number(l)/Number(u);if(!Number.isNaN(p))return p}return typeof s=="number"?s:16/9},a=s=>{const l=c(e.height),u=d(c(e.ratio));return l?S(l):`${Number(s)/u+c(t)}px`},i=()=>{o.value&&(r.value=a(o.value.clientWidth))};return w(()=>{i(),P(t)&&F(t,()=>i()),b("orientationchange",()=>i()),b("resize",()=>i())}),{el:o,width:n,height:r}},z=e=>R(e)?e:y(e),h=e=>{console.error("[PDF]: "+e)},j=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},k=e=>e==="string"?document.querySelector(e):e instanceof HTMLElement?e:document.body,H=e=>{let t="";return e&&(t+=I(e).map(([o,n])=>o==="noToolbar"?`toolbar=${n?0:1}`:`${encodeURIComponent(o)}=${encodeURIComponent(n)}`).join("&"),t&&(t="#"+t,t=t.slice(0,t.length-1))),t},T=(e,t,o,n,r)=>{j(t);let d=o;e==="pdfjs"&&(d=`${`${M(y(PDFJS_URL))}web/viewer.html`}?file=${encodeURIComponent(o)}${H(n)}`);const a=e==="pdfjs"||e==="iframe"?"iframe":"embed",i=document.createElement(a);return i.className="pdf-viewer",i.type="application/pdf",i.title=r,i.src=d,i instanceof HTMLIFrameElement&&(i.allow="fullscreen"),t.classList.add("pdf-viewer-container"),t.appendChild(i),t.getElementsByTagName(a)[0]},A=(e,t=null,{title:o,hint:n,options:r={}})=>{var d;if(typeof window>"u"||window.navigator===void 0||window.navigator.userAgent===void 0||window.navigator.mimeTypes===void 0)return null;const a=window.navigator,i=window.navigator.userAgent,s=window.Promise!==void 0,l=a.platform!==void 0&&a.platform==="MacIntel"&&a.maxTouchPoints!==void 0&&a.maxTouchPoints>1||D(i),u=!l&&E(i),p=!l&&/irefox/.test(i)&&i.split("rv:").length>1?parseInt(i.split("rv:")[1].split(".")[0],10)>18:!1,L=!l&&(s||p);if(!f(e))return h("URL is not valid"),null;const m=k(t);if(!m)return h("Target element cannot be determined"),null;const g=o||((d=/\/([^/]+).pdf/.exec(e))==null?void 0:d[1])||"PDF Viewer";return L||!l?T(u?"iframe":"embed",m,e,r,g):PDFJS_URL?T("pdfjs",m,e,r,g):(m.innerHTML=n.replace(/\[url\]/g,e),h("This browser does not support embedded PDFs"),null)};var B=C({name:"PDF",props:{url:{type:String,required:!0},title:{type:String,default:""},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:void 0},ratio:{type:[String,Number],default:16/9},page:{type:[String,Number],default:1},noToolbar:Boolean,zoom:{type:[String,Number],default:100}},setup(e){const{el:t,width:o,height:n}=U(e),r=x(PDF_LOCALES);return w(()=>{A(z(e.url),t.value,{title:e.title,hint:r.value.hint,options:{page:e.page,noToolbar:e.noToolbar,zoom:e.zoom}})}),()=>$("div",{class:"pdf-preview",ref:t,style:{width:o.value,height:n.value}})}});export{B as default};
//# sourceMappingURL=PDF.js.map
