{"version":3,"file":"Replit.js","sources":["../../../src/client/composables/size.ts","../../../src/client/components/Replit.ts"],"sourcesContent":["import { isString } from \"@vuepress/shared\";\nimport { type MaybeRef, useEventListener } from \"@vueuse/core\";\nimport { type Ref, computed, isRef, onMounted, ref, unref, watch } from \"vue\";\n\nconst getValue = (value: string | number): string =>\n  isString(value) ? value : `${value}px`;\n\nexport interface SizeOptions {\n  width: string | number | undefined;\n  height: string | number | undefined;\n  ratio: string | number | undefined;\n}\n\nexport interface SizeInfo<E extends HTMLElement> {\n  el: Ref<E | undefined>;\n  width: Ref<string>;\n  height: Ref<string>;\n}\n\nexport const useSize = <E extends HTMLElement>(\n  options: SizeOptions,\n  extraHeight: MaybeRef<number> = 0\n): SizeInfo<E> => {\n  const el = ref<E>();\n  const width = computed(() => getValue(unref(options.width) || \"100%\"));\n  const height = ref(\"auto\");\n\n  const getRadio = (ratio: number | string | undefined): number => {\n    if (isString(ratio)) {\n      const [width, height] = ratio.split(\":\");\n      const parsedRadio = Number(width) / Number(height);\n\n      if (!Number.isNaN(parsedRadio)) return parsedRadio;\n    }\n\n    return typeof ratio === \"number\" ? ratio : 16 / 9;\n  };\n\n  const getHeight = (width: number): string => {\n    const height = unref(options.height);\n    const ratio = getRadio(unref(options.ratio));\n\n    return height\n      ? getValue(height)\n      : `${Number(width) / ratio + unref(extraHeight)}px`;\n  };\n\n  const updateHeight = (): void => {\n    if (el.value) height.value = getHeight(el.value.clientWidth);\n  };\n\n  onMounted(() => {\n    updateHeight();\n    if (isRef(extraHeight)) watch(extraHeight, () => updateHeight());\n    useEventListener(\"orientationchange\", () => updateHeight());\n    useEventListener(\"resize\", () => updateHeight());\n  });\n\n  return {\n    el,\n    width,\n    height,\n  };\n};\n","/* eslint-disable vue/no-unused-properties */\nimport { type VNode, computed, defineComponent, h } from \"vue\";\n\nimport { useSize } from \"../composables/index.js\";\n\nimport \"../styles/repl-it.scss\";\n\nexport default defineComponent({\n  // eslint-disable-next-line vue/multi-word-component-names\n  name: \"Replit\",\n\n  props: {\n    /**\n     * Replit link\n     *\n     * Replit 链接\n     */\n    link: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * Replit username\n     *\n     * Replit 用户名\n     */\n    user: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * Replit repl name\n     *\n     * Replit repl 名\n     */\n    repl: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * Component width\n     *\n     * 组件宽度\n     */\n    width: {\n      type: [String, Number],\n      default: \"100%\",\n    },\n\n    /**\n     * Component height\n     *\n     * 组件高度\n     */\n    height: {\n      type: [String, Number],\n      default: undefined,\n    },\n\n    /**\n     * Component width / height ratio\n     *\n     * 组件长宽比\n     */\n    ratio: {\n      type: [String, Number],\n      default: 16 / 9,\n    },\n\n    /**\n     * Replit theme\n     *\n     * Replit 主题\n     */\n    theme: {\n      type: String,\n      default: \"light\",\n    },\n\n    /**\n     * The default file to open in the editor\n     *\n     * 默认打开的文件\n     */\n    file: {\n      type: String,\n      default: () => null,\n    },\n\n    /**\n     * show repl link\n     *\n     * 显示 repl 链接\n     */\n    plain: Boolean,\n\n    /**\n     * Button text\n     *\n     * 按钮文字\n     */\n    text: {\n      type: String,\n      default: \"Open on Replit\",\n    },\n  },\n\n  setup(props) {\n    const { el, width, height } = useSize<HTMLDivElement>(props);\n\n    const replLink = computed(() => {\n      if (props.link) {\n        const url = new URL(props.link);\n\n        if (props.plain) url.searchParams.delete(\"embed\");\n        else url.searchParams.set(\"embed\", \"true\");\n\n        return url.toString();\n      }\n\n      return props.user && props.repl\n        ? `https://replit.com/@${props.user}/${props.repl}${\n            props.plain ? \"\" : \"?embed=true\"\n          }${props.file?.length ? `#${props.file}` : \"\"}`\n        : null;\n    });\n\n    return (): VNode | null =>\n      replLink.value\n        ? h(\n            \"div\",\n            { class: \"replit-wrapper\" },\n            props.plain\n              ? h(\n                  \"button\",\n                  {\n                    class: \"replit-button\",\n                    onClick: () => {\n                      window.open(replLink.value!, \"_blank\");\n                    },\n                  },\n                  props.text\n                )\n              : h(\"iframe\", {\n                  ref: el,\n                  class: \"replit-iframe\",\n                  src: replLink.value,\n                  style: {\n                    width: width.value,\n                    height: height.value,\n                  },\n                })\n          )\n        : null;\n  },\n});\n"],"names":["getValue","value","isString","useSize","options","extraHeight","el","ref","width","computed","unref","height","getRadio","ratio","parsedRadio","getHeight","updateHeight","onMounted","isRef","watch","useEventListener","Replit","defineComponent","props","replLink","_a","url","h"],"mappings":"+OAIA,MAAMA,EAAYC,GAChBC,EAASD,CAAK,EAAIA,EAAQ,GAAGA,MAclBE,EAAU,CACrBC,EACAC,EAAgC,IAChB,CAChB,MAAMC,EAAKC,IACLC,EAAQC,EAAS,IAAMT,EAASU,EAAMN,EAAQ,KAAK,GAAK,MAAM,CAAC,EAC/DO,EAASJ,EAAI,MAAM,EAEnBK,EAAYC,GAA+C,CAC/D,GAAIX,EAASW,CAAK,EAAG,CACnB,KAAM,CAACL,EAAOG,CAAM,EAAIE,EAAM,MAAM,GAAG,EACjCC,EAAc,OAAON,CAAK,EAAI,OAAOG,CAAM,EAEjD,GAAI,CAAC,OAAO,MAAMG,CAAW,EAAG,OAAOA,EAGzC,OAAO,OAAOD,GAAU,SAAWA,EAAQ,GAAK,CAClD,EAEME,EAAaP,GAA0B,CAC3C,MAAMG,EAASD,EAAMN,EAAQ,MAAM,EAC7BS,EAAQD,EAASF,EAAMN,EAAQ,KAAK,CAAC,EAE3C,OAAOO,EACHX,EAASW,CAAM,EACf,GAAG,OAAOH,CAAK,EAAIK,EAAQH,EAAML,CAAW,KAClD,EAEMW,EAAe,IAAY,CAC3BV,EAAG,QAAOK,EAAO,MAAQI,EAAUT,EAAG,MAAM,WAAW,EAC7D,EAEA,OAAAW,EAAU,IAAM,CACdD,EAAa,EACTE,EAAMb,CAAW,GAAGc,EAAMd,EAAa,IAAMW,GAAc,EAC/DI,EAAiB,oBAAqB,IAAMJ,EAAc,CAAA,EAC1DI,EAAiB,SAAU,IAAMJ,EAAa,CAAC,CACjD,CAAC,EAEM,CACL,GAAAV,EACA,MAAAE,EACA,OAAAG,CACF,CACF,ECxDA,IAAAU,EAAeC,EAAgB,CAE7B,KAAM,SAEN,MAAO,CAML,KAAM,CACJ,KAAM,OACN,QAAS,EACX,EAOA,KAAM,CACJ,KAAM,OACN,QAAS,EACX,EAOA,KAAM,CACJ,KAAM,OACN,QAAS,EACX,EAOA,MAAO,CACL,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,MACX,EAOA,OAAQ,CACN,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,MACX,EAOA,MAAO,CACL,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,GAAK,CAChB,EAOA,MAAO,CACL,KAAM,OACN,QAAS,OACX,EAOA,KAAM,CACJ,KAAM,OACN,QAAS,IAAM,IACjB,EAOA,MAAO,QAOP,KAAM,CACJ,KAAM,OACN,QAAS,gBACX,CACF,EAEA,MAAMC,EAAO,CACX,KAAM,CAAE,GAAAjB,EAAI,MAAAE,EAAO,OAAAG,CAAO,EAAIR,EAAwBoB,CAAK,EAErDC,EAAWf,EAAS,IAAM,CAjHpC,IAAAgB,EAkHM,GAAIF,EAAM,KAAM,CACd,MAAMG,EAAM,IAAI,IAAIH,EAAM,IAAI,EAE9B,OAAIA,EAAM,MAAOG,EAAI,aAAa,OAAO,OAAO,EAC3CA,EAAI,aAAa,IAAI,QAAS,MAAM,EAElCA,EAAI,SAAS,EAGtB,OAAOH,EAAM,MAAQA,EAAM,KACvB,uBAAuBA,EAAM,QAAQA,EAAM,OACzCA,EAAM,MAAQ,GAAK,iBAClBE,EAAAF,EAAM,OAAN,MAAAE,EAAY,OAAS,IAAIF,EAAM,OAAS,KAC3C,IACN,CAAC,EAED,MAAO,IACLC,EAAS,MACLG,EACE,MACA,CAAE,MAAO,gBAAiB,EAC1BJ,EAAM,MACFI,EACE,SACA,CACE,MAAO,gBACP,QAAS,IAAM,CACb,OAAO,KAAKH,EAAS,MAAQ,QAAQ,CACvC,CACF,EACAD,EAAM,IACR,EACAI,EAAE,SAAU,CACV,IAAKrB,EACL,MAAO,gBACP,IAAKkB,EAAS,MACd,MAAO,CACL,MAAOhB,EAAM,MACb,OAAQG,EAAO,KACjB,CACF,CAAC,CACP,EACA,IACR,CACF,CAAC"}