import{usePageData as b,useSiteData as L,defineClientConfig as x}from"@vuepress/client";import{defineComponent as y,computed as U,h as a}from"vue";import{useLocaleConfig as k,startsWith as _,keys as w,endsWith as d,hasGlobalComponent as I}from"vuepress-shared/client";import{useRouter as R,RouterLink as g}from"vue-router";import A from"vuepress-plugin-components/client/components/FontIcon.js";import"./styles/auto-catalog.scss";var M=y({name:"AutoCatalog",props:{base:{type:String,default:""},level:{type:Number,default:3},titleGetter:{type:Function,default:l=>l.title},iconGetter:{type:Function,default:l=>l.icon},orderGetter:{type:Function,default:l=>l.order||0},shouldIndex:{type:Function,default:l=>l.index!==!1}},setup(l){const f=k(AUTO_CATALOG_LOCALES),s=b(),C=R(),T=L(),$=()=>{const u=l.base||s.value.path.replace(/\/[^/]+$/,"/"),m=C.getRoutes(),h=[];return m.filter(({meta:t,path:e})=>{if(!_(e,u)||e===u)return!1;if(u==="/"){const n=w(T.value.locales).filter(o=>o!=="/");if(e==="/404.html"||n.some(o=>_(e,o)))return!1}return(d(e,".html")&&!d(e,"/index.html")||d(e,"/"))&&l.shouldIndex(t)}).map(({path:t,meta:e})=>{const n=t.substring(u.length).split("/").length;return{title:l.titleGetter(e),icon:l.iconGetter(e),base:t.replace(/\/[^/]+\/?$/,"/"),order:l.orderGetter(e)||null,level:d(t,"/")?n-1:n,path:t}}).filter(({title:t,level:e})=>e<=l.level||!t).sort(({title:t,level:e,path:n,order:o},{title:i,level:r,path:p,order:c})=>e-r||(d(n,"/index.html")?-1:d(p,"/index.html")?1:o===null?c===null?t.localeCompare(i):c:c===null?o:o>0?c>0?o-c:-1:c<0?o-c:1)).forEach(t=>{var e;const{base:n,level:o}=t;switch(o){case 1:h.push(t);break;case 2:{const i=h.find(r=>r.path===n);i&&(i.children??(i.children=[])).push(t);break}default:{const i=h.find(r=>r.path===n.replace(/\/[^/]+\/$/,"/"));if(i){const r=(e=i.children)==null?void 0:e.find(p=>p.path===n);r&&(r.children??(r.children=[])).push(t)}}}}),h},G=U(()=>$());return()=>a("div",{class:"auto-catalog-wrapper"},[a("h2",{class:"main-title"},f.value.title),...G.value.map(({children:u=[],icon:m,path:h,title:t},e)=>[a("h3",{id:t,class:["child-title",{"has-children":u.length}]},[a("a",{href:`#${t}`,class:"header-anchor"},"#"),a(g,{class:"catalog-title",to:h},()=>[m?a(A,{icon:m}):null,`${e+1}. ${t||"Unknown"}`])]),u.length?a("ul",{class:"child-catalog-wrapper"},u.map(({children:n=[],icon:o,path:i,title:r},p)=>a("li",{class:"child-catalog-item"},[a("div",{class:["sub-title",{"has-children":n.length}]},[a("a",{href:`#${r}`,class:"header-anchor"},"#"),a(g,{class:"catalog-title",to:i},()=>[o?a(A,{icon:o}):null,`${e+1}.${p+1} ${r||"Unknown"}`])]),n.length?a("div",{class:"sub-catalog-wrapper"},n.map(({icon:c,path:v,title:E},O)=>a(g,{class:"sub-catalog-item",to:v},()=>[c?a(A,{icon:c}):null,`${e+1}.${p+1}.${O+1} ${E||"Unknown"}`]))):null]))):null])])}}),D=x({enhance:({app:l})=>{I("AutoCatalog",l)||l.component("AutoCatalog",f=>a(M,{titleGetter:s=>s[AUTO_CATALOG_TITLE_META_KEY],iconGetter:s=>s[AUTO_CATALOG_ICON_META_KEY],orderGetter:s=>s[AUTO_CATALOG_ORDER_META_KEY],shouldIndex:s=>Boolean(s[AUTO_CATALOG_INDEX_META_KEY]),...f}))}});export{D as default};
//# sourceMappingURL=config.js.map
